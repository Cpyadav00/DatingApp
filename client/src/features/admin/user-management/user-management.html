<div class="h-[75vh] overflow-auto rounded-box border border-base-content/5 bg-base-100 p-2 sm:p-4">
    <div class="overflow-x-auto">
        <table class="table table-zebra w-full min-w-[500px]">
            <thead>
                <tr>
                    <th class="text-sm sm:text-base">Email</th>
                    <th class="text-sm sm:text-base">Active Roles</th>
                    <th class="text-sm sm:text-base">Actions</th>
                </tr>
            </thead>
            <tbody>
                @for (user of users(); track user.id) {
                <tr>
                    <td class="text-xs sm:text-sm break-all">{{user.email}}</td>
                    <td class="text-xs sm:text-sm break-all">{{user.roles}}</td>
                    <td>
                        <button 
                            (click)="opneRolesModal(user)" 
                            class="btn btn-primary btn-xs sm:btn-sm md:btn-md">
                            Edit roles
                        </button>
                    </td>
                </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<dialog #rolesModal class="modal">
    <div class="modal-box w-full max-w-sm sm:max-w-xl">
        <h3 class="text-base sm:text-lg font-bold mb-4">
            Edit roles for {{selectedUser?.email}}
        </h3>

        <fieldset class="fieldset w-full p-3 sm:p-4 bg-base-100 border-base-300 rounded-box">
            <legend class="fieldset-legend text-sm sm:text-base">Select roles</legend>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                @for (role of availableRoles; track $index) {
                    <label class="fieldset-label flex items-center gap-2 text-sm sm:text-base">
                        <input 
                            (change)="toggleRole($event,role)"
                            type="checkbox"
                            [checked]="selectedUser?.roles?.includes(role)"
                            class="checkbox checkbox-sm sm:checkbox-md"
                            [disabled]="selectedUser?.email==='admin@test.com' && role==='Admin'">
                        {{role}}
                    </label>
                }
            </div>
        </fieldset>

        <div class="modal-action mt-4">
            <button 
                (click)="updateRoles()" 
                class="btn btn-primary btn-sm sm:btn-md">
                Submit
            </button>
        </div>
    </div>

    <form method="dialog" class="modal-backdrop">
        <button>Close</button>
    </form>
</dialog>
